<!DOCTYPE html>
<html lang="en-gb">
<head>
    <meta charset="UTF-8">
    <title>how to setup vpn on remote linux machine</title>
    <meta name="description" content="">

    <meta name=”robots” content="index, follow">
    <link rel="canonical" href="https:&#x2F;&#x2F;yneth.github.io&#x2F;snippets&#x2F;vpn-on-remote-linux-machine&#x2F;">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="author" content="Anthony (Yneth)">

    <meta property="og:title" content="how to setup vpn on remote linux machine">
    <meta property="og:description"
          content="">
    
    
    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="how to setup vpn on remote linux machine">
    <meta name="twitter:description"
          content="">
    

    <link rel="stylesheet" href="https://yneth.github.io/styles.css?h=a58ef5aef352a232cf15"/>

    <link rel="shortcut icon" type="image/png" href="https://yneth.github.io/favicon.png"/>
    <link href="https://yneth.github.io/rss.xml" rel="feed" type="application/rss+xml" title="Yneth Blog"/>

    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5G27JJJ');</script>
    <!-- End Google Tag Manager -->
</head>


<body class="flex flex-col min-h-screen p-4">

<!-- Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5G27JJJ"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->

<header class="flex flex-col justify-between px-4 md:h-16 md:flex-row">

    <h1 class="py-4 text-xl text-center">
        <a class="text-black" href="/">Yneth</a>
    </h1>

    <ul class="mt-2 flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4 items-center justify-around">
        <li><a href="/blog/">Blog</a></li>
        <li><a href="/snippets/">Snippets</a></li>
        <li><a href="/tags/">Tags</a></li>
    </ul>

</header>

<main class="grow flex flex-col items-center h-full">
    
    <article class="md:w-[48em] border-1 border-y border-black mt-8 py-2 w-full grow whitespace-normal">
        <h1>how to setup vpn on remote linux machine</h1>
        <div>
            2022-03-01
            
        </div>

        <hr/>

        
            <ul class="flex flex-row flex-wrap gap-x-2">
                
                    <li><a href="https://yneth.github.io/tags/snippet/">#snippet</a></li>
                
                    <li><a href="https://yneth.github.io/tags/linux/">#linux</a></li>
                
                    <li><a href="https://yneth.github.io/tags/iproutes/">#iproutes</a></li>
                
                    <li><a href="https://yneth.github.io/tags/bash/">#bash</a></li>
                
                    <li><a href="https://yneth.github.io/tags/vpn/">#vpn</a></li>
                
            </ul>
        

        <div class="article__content mt-4">
            <pre data-lang="text" style="background-color:#f5f5f5;color:#1f1f1f;" class="language-text "><code class="language-text" data-lang="text"><span>a.b.c.d    — public IP
</span><span>a.b.c.0/24 — public IP subnet
</span><span>x.x.x.1     — gateway
</span></code></pre>
<p>To find gateway: <code>ip route | grep default</code></p>
<pre data-lang="bash" style="background-color:#f5f5f5;color:#1f1f1f;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#5597d6;">ip</span><span> rule add table 128 from a.b.c.d`
</span><span style="color:#5597d6;">ip</span><span> route add table 128 to a.b.c.0/24 dev eth0
</span><span style="color:#5597d6;">ip</span><span> route add table 128 default via x.x.x.1
</span></code></pre>
<p>and make sure table 128 is first after loopback in the rules.</p>
<p>To check: <code>ip rule</code></p>
<p>To change order: </p>
<pre data-lang="bash" style="background-color:#f5f5f5;color:#1f1f1f;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#5597d6;">ip</span><span> rule add pref YYY from a.b.c.d lookup 128
</span><span style="color:#5597d6;">ip</span><span> rule del pref XXX from a.b.c.d lookup 128
</span></code></pre>
<p>where </p>
<ul>
<li><code>XXX</code> is the current priority value </li>
<li><code>YYY</code> &gt; 0 &amp;&amp; <code>YYY</code> &lt; (first after loopback)</li>
</ul>
<p>Sources:</p>
<ul>
<li><a href="https://linux.die.net/man/8/ip">https://linux.die.net/man/8/ip</a></li>
</ul>

        </div>
    </article>

    <section class="w-full mt-8 py-2">
        <script src="https://utteranc.es/client.js"
                repo="yneth/yneth.github.io"
                issue-term="pathname"
                theme="github-light"
                crossorigin="anonymous"
                async>
        </script>
    </section>

</main>

</body>
</html>
